## 🧩 GDB `watchpoint` 行为笔记

### 📘1. watchpoint 是什么

`watch <变量名>` 用于 **监视变量值的变化**。
 当变量的值发生改变时，程序会 **自动暂停执行**，并打印旧值与新值。

------

### ⚙️2. 为什么 `n`（next） 不触发 watchpoint

- `n` 是 **手动单步执行**，GDB 在每一行执行完后主动暂停。
- 程序没有“自由运行”，GDB 不会自动检测变量变化事件。
- 所以即使变量变了，**watchpoint 也不会触发中断**或打印旧值/新值。

🧠 类比：你一步步走路（`n`），CPU 没机会自己发现变化。

------

### 🚀3. 为什么 `c`（continue） 能触发 watchpoint

- `c` 是 **让程序自由执行**，GDB 把控制权交给 CPU。

- CPU 的硬件监视机制会检测变量内存是否变化。

- 每当变化时，GDB 会收到中断信号并暂停执行，
   输出：

  ```
  Hardware watchpoint 1: i
  Old value = 1
  New value = 2
  ```

🧠 类比：你放开手让程序跑，它自己发现变量变了，就会被“叫停”。

------

### 📊4. 小结对比

| 命令 | 程序是否自由运行 | watchpoint 是否触发 | 说明                     |
| ---- | ---------------- | ------------------- | ------------------------ |
| `n`  | 否（手动一步步） | ❌ 不触发            | 你自己控制每步执行       |
| `c`  | 是（自由执行）   | ✅ 触发              | 程序自动暂停在变量变化处 |

------

### ✅ 5. 正确使用方法示例

```
(gdb) b main
(gdb) r
(gdb) watch i
(gdb) c
```

程序每次 `i` 改变时都会自动停下并输出旧值与新值。